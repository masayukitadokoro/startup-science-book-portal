-- =====================================================
-- 初期プロンプトデータ
-- =====================================================

-- 章IDを取得
DO $$
DECLARE
    chapter_3_id UUID;
BEGIN
    SELECT id INTO chapter_3_id FROM public.chapters WHERE chapter_number = 3 LIMIT 1;

    -- プロンプトデータ挿入
    INSERT INTO public.prompts (chapter_id, step_number, title, purpose, category, prompt_text, access_level, tags, usage_tips, sort_order) VALUES
    
    -- Step 2: フィーチャー洗い出し
    (chapter_3_id, 2, 'フィーチャー洗い出しプロンプト', 
    'リーンキャンバスとモチベーショングラフから必要な機能を体系的に抽出', 
    '機能設計',
    '添付のリーンキャンバスとモチベーショングラフを詳細に分析し、本ソリューションに必要な機能（フィーチャー）を体系的に洗い出してください。

分析の観点：
課題解決の観点：リーンキャンバスに記載された顧客課題を解決するために不可欠な機能
価値提案の実現：独自の価値提案を具現化するために必要な機能
モチベーション維持：モチベーショングラフから読み取れるユーザーの心理的変化に対応する機能
差別化要素：競合との差別化を実現する機能

アウトプット形式：
各機能について以下を明記してください：
機能名：簡潔でわかりやすい名称
目的：どの課題/ニーズに対応するか
優先度：高 / 中 / 低
期待される効果：ユーザーにもたらす価値
実装の複雑度：高・中・低（optional）',
    'public',
    ARRAY['リーンキャンバス', 'モチベーショングラフ', 'フィーチャー', '優先度'],
    '[ ] で囲まれた部分は、あなたのプロジェクトに合わせて置き換えてください。ChatGPT、Claude、Gemini など任意の生成AIで使用できます。',
    1),

    -- Step 3: フィーチャーグルーピング
    (chapter_3_id, 3, 'フィーチャーグルーピングプロンプト',
    'フィーチャーリストをユーザー目的別に論理的に整理',
    '機能設計',
    '以下のフィーチャーリストを、ユーザーの目的や利用シーンに基づいて論理的にグルーピングしてください。

【フィーチャーリスト】
[ここにフィーチャーリストを挿入]

【条件】
- 各グループには分かりやすい名前を付けてください
- ユーザーの行動フローを考慮してグルーピングしてください
- 各フィーチャーがなぜそのグループに分類されるかの理由も説明してください
- 類似機能や競合がありそうなフィーチャーは優先度も含めて整理してください

【出力形式】
グループ名：[名前]
- フィーチャー1：[理由]
- フィーチャー2：[理由]
…',
    'public',
    ARRAY['グルーピング', 'カードソート', 'ユーザー目的', '行動フロー'],
    'Step 2で作成したフィーチャーリストをそのまま入力すると効果的です。',
    2),

    -- Step 4: カスタマープロダクトジャーニー
    (chapter_3_id, 4, 'カスタマープロダクトジャーニー設計プロンプト',
    'ペルソナに基づく最適なユーザーフローを複数パターン生成',
    'UX設計',
    '以下のペルソナ情報とフィーチャーグループを基に、最適なカスタマーのプロダクトジャーニーを3パターン提案してください。初期プロダクトなので、優先順位の低いものは、スキップして優先順位の高いフィーチャーをベースにしてください

【ペルソナ情報】
[ここにペルソナ詳細を挿入]

【フィーチャーグループ】
[ここにStep1でグルーピングした結果を挿入]

【条件】
- ユーザーの感情状態やストレスポイントを考慮してください
- 初回利用者と既存ユーザーの違いを意識してください
- 各フローでのユーザーの期待値と不安要素を明記してください
- タッチポイント数を最小限に抑えつつ、必要な情報は確実に取得できるフローにしてください

【出力形式】
パターン1：[シナリオ名]
ステップ1 → ステップ2 → ...
（各ステップでのユーザー心理や期待も含める）',
    'public',
    ARRAY['ペルソナ', 'ジャーニー', 'UX', 'ユーザーフロー', '感情設計'],
    '前の章で作成したペルソナ情報を詳細に記載するほど、精度の高いジャーニーが生成されます。',
    3),

    -- Step 5: UI要素・コンテンツ設計
    (chapter_3_id, 5, 'UI要素・コンテンツ設計プロンプト',
    '各画面に必要なUI要素とコンテンツを具体化',
    'UI設計',
    '添付のユーザーフローを実現するためのアプリのUIについて、具体的なUI要素と画面に置くコンテンツを詳細に提案してください。

【条件】
- ユーザビリティの観点から必須となるUI要素を列挙してください
- ユーザーが迷わないための視覚的ヒントや説明文も提案してください
- アクセシビリティを考慮した代替手段も含めてください
- 画面サイズ（モバイル/デスクトップ）ごとの違いがあれば言及してください

【出力形式】
表形式で出力
縦軸　必須UI要素リスト：
横軸
画面名：[例：ダッシュボード画面]
機能説明：【例：グラフのビジュアル切り替えボタンなど】
目的：[例：ユーザーが現在の使用状況を把握し、次のアクションを決定する]
想定ユーザーアクション：[例：使用量確認、追加購入、設定変更]
優先順位：最高5 最低1',
    'authenticated',
    ARRAY['UI', 'コンテンツ', 'アクセシビリティ', 'レスポンシブ'],
    'Step 4で作成したユーザーフローを添付すると、より具体的な提案が得られます。',
    4),

    -- Step 6: 画面遷移実装（Vibeコーディング）
    (chapter_3_id, 6, '画面遷移実装プロンプト（Vibeコーディング）',
    '画面遷移フローからプロトタイプコードを生成',
    'プロトタイピング',
    '【アプリ概要】
[ここにアプリの基本情報を挿入]

【画面遷移フロー】
1. [画面名] → 2. [画面名] → 3. [画面名] ...

【各画面の仕様】
画面1：[画面名]
- 表示要素：[UI要素リスト]
- インタラクション：[ボタンクリック等の動作]
次画面への遷移条件：[条件]',
    'authenticated',
    ARRAY['Vibeコーディング', 'プロトタイプ', 'React', '画面遷移'],
    'Cursor、GitHub Copilot、Replit等のAIコーディングツールと組み合わせて使用すると効果的です。',
    5),

    -- Step 7: 画面デザイン作成
    (chapter_3_id, 7, '画面デザイン作成プロンプト',
    '画面遷移図からビジュアルデザインを生成',
    'ビジュアルデザイン',
    '添付の画面遷移図をベースに、各画面のビジュアルイメージを作成してください。

必要情報の入力
作成前に、以下の情報を教えてください：

1. プロジェクト基本情報

2. ターゲットユーザー（ペルソナ）

3. プラットフォーム・技術仕様
デバイス：（Webブラウザ/iOS/Android/その他）
推奨解像度：
対応言語：

4. デザイン方向性
デザインスタイル：（ミニマル/モダン/ポップ/コーポレート/その他）
トーン＆マナー：（フレンドリー/プロフェッショナル/カジュアル/その他）
主要カラー：（既にブランドカラーがあれば）
参考デザイン：（あれば URL やイメージ）

5. 各画面の詳細要件
前の画面繊維図を添付する
画面遷移図の各画面について：
含めるべき主要機能・要素
優先度の高い情報
特に注意すべきUX上のポイント

6. その他の要望
アクセシビリティ要件：
特別な制約事項：
その他の要望：

出力形式 上記情報に基づき、各画面のビジュアルデザインを作成。各画面には以下を含めます：
レイアウト構造
UI要素（ボタン、フォーム、ナビゲーション等）
カラースキーム
タイポグラフィ
インタラクション要素',
    'authenticated',
    ARRAY['ビジュアル', 'デザイン', 'Manus', 'Genspark', 'モックアップ'],
    'ManusやGensparkなどのツールと組み合わせると、実際の画面イメージを生成できます。',
    6);

END $$;

-- サンプルリソース追加
DO $$
DECLARE
    chapter_3_id UUID;
BEGIN
    SELECT id INTO chapter_3_id FROM public.chapters WHERE chapter_number = 3 LIMIT 1;

    INSERT INTO public.resources (chapter_id, title, description, resource_type, external_url, access_level, sort_order) VALUES
    (chapter_3_id, 'プロダクト設計スライド', '第3章の講義スライド（PDF）', 'slide', NULL, 'authenticated', 1),
    (chapter_3_id, 'フィーチャーリストテンプレート', 'スプレッドシートテンプレート', 'spreadsheet', 'https://docs.google.com/spreadsheets/d/1Ew_7gBPIXGWWuJzEIZWqr8-rh0NNkIK3puavsf6YXb0/edit', 'authenticated', 2),
    (chapter_3_id, 'カスタマージャーニーマップサンプル', 'FigJamテンプレート', 'link', NULL, 'authenticated', 3);
END $$;

-- QRコードサンプル
INSERT INTO public.qr_codes (book_id, code, label, target_path) 
SELECT id, 'KAGAKU-CH3-2024', '第3章プロンプト', '/prompts?chapter=3'
FROM public.books WHERE slug = 'kagaku-of-startup';
